<html>
<head>
<title>{% block title %}{% endblock %}</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" integrity="sha512-z3gLpd7yknf1YoNbCzqRKc4qyor8gaKU1qmn+CShxbuBusANI9QpRohGBreCFkKxLhei6S9CQXFEbbKuqLg0DA==" crossorigin="anonymous" referrerpolicy="no-referrer" />

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.4.1/dist/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
<link rel = "stylesheet" type="text/css" href = "{{url_for('static', filename='style.css')}}">
{% block custom_css %}{% endblock %}
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body onload="checkProfile()">
    <div>
    <nav class="base-nav">
        <label class="logo">E&E</label>
      <ul>
        <li><a href="{{url_for('logout')}}"><img src= "{{url_for('static', filename='exit.png')}}" alt="Exit" class="icon"/></a></li>

        <li><a href="{{url_for('recruit')}}"><img src="{{url_for('static', filename='recr.png')}}" alt="Graph" class="icon" id="recruit-icon" style="display: none;"/></a></li>
    
    
      <li><a href="{{url_for('predict')}}"><img src= "{{url_for('static', filename='graph.png')}}" alt="Graph" class="icon"/></a></li>
      <li><a onclick=" loadProfile()"><img src= "{{url_for('static', filename='person.png')}}" alt="Profile" class="icon"/></a></li>
    </ul>
    </nav>
    {% block content %}
    {% endblock %}
    </div>
    <footer class="footer">
        <p class="left-sentence">Connecting talent with opportunity, one E&E step at a time</p>
        <p class="right-sentence">&copy; 2023 E&E. All rights reserved.</p>
      </footer>
    
      <script src="{{url_for('static', filename='script.js')}}"></script>
      
</body>


<script>

  
function loadProfile() {
    // Make an AJAX request to the profile endpoint
    var xhr = new XMLHttpRequest();
    xhr.open("GET", '/your_profile', true);

    xhr.onreadystatechange = function () {
        if (xhr.readyState == 4 && xhr.status == 200) {
            // Parse the JSON response
            var jsonResponse = JSON.parse(xhr.responseText);

            // Check if the user is authenticated
            if (jsonResponse.authenticated) {
                // Get the user ID from the response
                var userId = jsonResponse.user_id;

                // Redirect to the profile page with the user ID
                window.location.href = '/profile?user_id=' + userId;
            } else {
                // Handle the case where the user is not authenticated
                alert("You are not authenticated. Please log in.");
                // Or perform other actions based on your requirements
            }
        }
    };

    xhr.send();
}


function checkProfile() {
    var xhr = new XMLHttpRequest();
    xhr.open("GET", "/some_route", true);
    xhr.setRequestHeader("Content-Type", "application/json");

    xhr.onreadystatechange = function () {
        if (xhr.readyState == 4 && xhr.status == 200) {
            // Parse the JSON response
            var response = JSON.parse(xhr.responseText);

            // Get the recruit-icon element
            var recruitIcon = document.getElementById('recruit-icon');

            // Check if the user is a recruiter and adjust the display of the recruit-icon
            if (response.user_role === 'recruiter') {
                recruitIcon.style.display = 'inline-block';
            } else {
                recruitIcon.style.display = 'none';
            }
        }
    };

    xhr.send();
}



</script>

</html>